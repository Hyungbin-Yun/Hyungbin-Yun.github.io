<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ TOP10 ëŒ€ì‹œë³´ë“œ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #0d5aa7;
            --secondary-blue: #1e7ec8;
            --accent-teal: #00b8d4;
            --light-blue: #e3f2fd;
            --dark-blue: #01579b;
            --hover-blue: #bbdefb;
            
            --white: #ffffff;
            --gray-50: #f8fafb;
            --gray-100: #ecf5f9;
            --gray-200: #d9e5ed;
            --gray-300: #b8cdd9;
            --gray-400: #8ba8ba;
            --gray-500: #5e7a8a;
            --gray-600: #3d5566;
            --gray-700: #2c3e4d;
            --gray-800: #1a2833;
            --gray-900: #0f1822;
            --black: #000000;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'IBM Plex Sans KR', -apple-system, sans-serif;
            background: #f5f5f5;
            color: var(--gray-900);
            min-height: 100vh;
            padding: 2rem;
            line-height: 1.6;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        /* Navigation Bar */
        .nav-bar {
            background: var(--white);
            border-bottom: 2px solid #e0e0e0;
            margin: -2rem -2rem 2rem -2rem;
            padding: 0;
        }

        .nav-container {
            max-width: 1800px;
            margin: 0 auto;
            display: flex;
            gap: 0;
            padding: 0 2rem;
        }

        .nav-tab {
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            color: #666;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
            border-bottom: 3px solid transparent;
            font-family: 'IBM Plex Sans KR', sans-serif;
        }

        .nav-tab:hover {
            color: #333;
            background: #f9f9f9;
        }

        .nav-tab.active {
            color: rgb(12,62,196);
            border-bottom-color: rgb(12,62,196);
            font-weight: 600;
        }

        /* Header */
        .header {
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            letter-spacing: -0.01em;
        }

        .header-subtitle {
            font-size: 0.95rem;
            color: var(--secondary-blue);
            font-weight: 500;
            letter-spacing: 0.02em;
        }

        /* Filters Section */
        .filters-section {
            background: var(--white);
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
        }

        .filters {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            align-items: center;
            justify-content: flex-start;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
        }

        select {
            padding: 0.5rem 2rem 0.5rem 0.75rem;
            background: var(--white);
            border: 1px solid #d0d0d0;
            color: #333;
            font-size: 0.85rem;
            font-family: 'IBM Plex Sans KR', sans-serif;
            font-weight: 400;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%23666' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            min-width: 200px;
        }

        select:hover {
            border-color: #999;
        }

        select:focus {
            outline: none;
            border-color: #1976d2;
            box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.1);
        }

        /* Product Tabs */
        .product-tabs {
            border-top: 1px solid #e0e0e0;
            padding-top: 0.75rem;
        }

        .product-tabs-label {
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .tabs-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tab {
            padding: 0.5rem 1rem;
            background: var(--white);
            border: 1px solid rgb(122,122,122);
            color: #666;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
            border-radius: 4px;
        }

        .tab:hover {
            border-color: rgb(122,122,122);
            color: #333;
            background: #f9f9f9;
        }

        .tab.active {
            background: rgb(12,62,196);
            color: var(--white);
            border-color: rgb(12,62,196);
            font-weight: 600;
        }

        .total-count {
            margin-top: 1rem;
            font-size: 0.8rem;
            color: #666;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Two Column Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 40% 60%;
            gap: 1rem;
            align-items: start;
        }

        /* Left Column - Table */
        .left-column {
            background: var(--white);
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }

        .table-header {
            padding: 0.875rem 1.25rem;
            border-bottom: 2px solid #f0f0f0;
            background: #fafafa;
        }

        .table-title {
            font-size: 1rem;
            font-weight: 700;
            color: #333;
        }

        .table-wrapper {
            max-height: 700px;
            overflow-y: auto;
            overflow-x: auto;
            border-top: 1px solid #e0e0e0;
        }

        .table-wrapper::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .table-wrapper::-webkit-scrollbar-track {
            background: #f5f5f5;
        }

        .table-wrapper::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 3px;
        }

        .table-wrapper::-webkit-scrollbar-thumb:hover {
            background: #999;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: rgb(18,45,143);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 0.875rem 1rem;
            text-align: center;
            font-size: 0.85rem;
            color: var(--white);
            font-weight: 600;
            border-bottom: none;
            background: transparent;
        }

        tbody tr {
            border-bottom: 1px solid #e8e8e8;
            transition: var(--transition);
            cursor: pointer;
        }

        tbody tr:hover {
            background: #f5f5f5;
        }

        tbody tr.active {
            background: #e3f2fd;
        }

        td {
            padding: 0.875rem 1rem;
            color: #333;
            font-size: 0.85rem;
            text-align: center;
        }

        .badge-rank {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            background: #e3f2fd;
            border: 1px solid #2196f3;
            color: #1976d2;
            min-width: 40px;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
            border-radius: 3px;
        }

        .badge-rank.top {
            background: #1976d2;
            color: var(--white);
            border-color: #1976d2;
            font-weight: 700;
        }

        .number-cell {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: rgb(18,45,143);
            font-size: 0.9rem;
        }

        /* Rank cell styling */
        td:first-child {
            font-weight: 600;
            color: #333;
            font-size: 0.85rem;
        }

        /* Right Column - Details */
        .right-column {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            position: sticky;
            top: 2rem;
        }

        .detail-section {
            background: var(--white);
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            margin-bottom: 0;
        }

        .detail-header {
            padding: 0.875rem 1.25rem;
            border-bottom: 1px solid #f0f0f0;
            background: var(--white);
        }

        .detail-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .detail-title .emoji {
            font-size: 1rem;
        }

        .detail-meta {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: #999;
            font-family: 'IBM Plex Sans KR', sans-serif;
            font-weight: 400;
        }

        .detail-content {
            padding: 1.25rem;
        }

        /* Know-how Empty State */
        .knowhow-empty {
            text-align: center;
            padding: 3rem 2rem;
            background: #f5f5f5;
            border: none;
        }

        .knowhow-empty-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .knowhow-empty-text {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1.5rem;
            font-weight: 400;
        }

        .knowhow-content {
            background: #fafafa;
            border-left: 3px solid rgb(12,62,196);
            padding: 1.5rem;
            white-space: pre-wrap;
            line-height: 1.8;
            font-size: 0.85rem;
            color: #333;
            margin-bottom: 1.5rem;
        }

        .btn {
            padding: 0.625rem 1.5rem;
            background: var(--white);
            border: 1px solid rgb(122,122,122);
            color: #666;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            font-family: 'IBM Plex Sans KR', sans-serif;
            border-radius: 4px;
        }

        .btn:hover {
            background: #f5f5f5;
            border-color: #666;
            color: #333;
        }

        .btn-primary {
            background: rgb(12,62,196);
            color: var(--white);
            border-color: rgb(12,62,196);
            font-weight: 600;
            border-radius: 4px;
        }

        .btn-primary:hover {
            background: rgb(10,50,170);
            border-color: rgb(10,50,170);
        }

        /* Stats Grid */
        .stats-selector {
            margin-bottom: 1.5rem;
        }

        .stats-selector label {
            display: block;
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .stats-selector select {
            width: 100%;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }

        .stat-item {
            background: #fafafa;
            padding: 1.25rem 1rem;
            text-align: center;
            transition: var(--transition);
            border: 1px solid #f0f0f0;
        }

        .stat-item:hover {
            background: #f5f5f5;
            transform: translateY(-2px);
        }

        .stat-label {
            font-size: 0.75rem;
            color: rgb(12,62,196);
            margin-bottom: 0.75rem;
            font-weight: 500;
        }

        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            letter-spacing: -0.02em;
            color: rgb(18,45,143);
            margin-bottom: 0.5rem;
        }

        .stat-sublabel {
            font-size: 0.75rem;
            color: #999;
            margin-top: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 400;
        }

        /* Target List */
        .target-list-wrapper {
            max-height: 400px;
            overflow-y: auto;
        }

        .target-list-wrapper::-webkit-scrollbar {
            width: 8px;
        }

        .target-list-wrapper::-webkit-scrollbar-track {
            background: var(--gray-100);
        }

        .target-list-wrapper::-webkit-scrollbar-thumb {
            background: var(--gray-400);
            border-radius: 4px;
        }

        .target-list-wrapper::-webkit-scrollbar-thumb:hover {
            background: var(--gray-600);
        }

        .target-card {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--gray-200);
            transition: var(--transition);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem;
        }

        .target-card:last-child {
            border-bottom: none;
        }

        .target-card:hover {
            background: var(--hover-blue);
            padding-left: 2.5rem;
            box-shadow: 0 2px 8px rgba(13, 90, 167, 0.1);
        }

        .target-info {
            flex: 1;
        }

        .target-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-blue);
        }

        .target-meta {
            font-size: 0.85rem;
            color: var(--secondary-blue);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease-out;
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--white);
            width: 90%;
            max-width: 700px;
            max-height: 85vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .modal-header {
            padding: 1.5rem 2rem;
            background: rgb(18,45,143);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 12px 12px 0 0;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--white);
        }

        .modal-subtitle {
            padding: 1rem 2rem;
            background: #f5f5f5;
            font-size: 0.85rem;
            color: #666;
            border-bottom: 1px solid #e0e0e0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.75rem;
            cursor: pointer;
            color: var(--white);
            transition: var(--transition);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.9;
        }

        .modal-close:hover {
            opacity: 1;
        }

        .modal-body {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.75rem;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--white);
            border: 1px solid #d0d0d0;
            color: #333;
            font-size: 0.85rem;
            font-family: 'IBM Plex Sans KR', sans-serif;
            transition: var(--transition);
            border-radius: 4px;
        }

        .form-textarea {
            min-height: 300px;
            resize: vertical;
            font-family: 'IBM Plex Sans KR', sans-serif;
            line-height: 1.7;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: rgb(12,62,196);
            box-shadow: 0 0 0 2px rgba(12,62,196, 0.1);
        }

        .char-count {
            text-align: right;
            font-size: 0.8rem;
            color: #999;
            margin-top: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .modal-footer {
            padding: 1.25rem 2rem;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
            background: #fafafa;
        }

        .modal-footer .btn {
            min-width: 80px;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }

            .right-column {
                position: static;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation Bar -->
        <div class="nav-bar">
            <div class="nav-container">
                <a href="index.html" class="nav-tab active">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a>
                <a href="knowhow.html" class="nav-tab">ğŸ’¡ ì˜ì—… ë…¸í•˜ìš°</a>
            </div>
        </div>

        <!-- Header -->
        <div class="header">
            <h1>ìƒí’ˆ TOP10 ëŒ€ì‹œë³´ë“œ</h1>
        </div>

        <!-- Filters Section -->
        <div class="filters-section">
            <div class="filters">
                <label class="filter-label" style="margin-bottom: 0;">ê¸°ì¤€ ì£¼ì°¨</label>
                <select id="weekSelector" onchange="applyFilters()">
                    <option value="2024-W49">2024-W49 (12/02~12/08)</option>
                    <option value="2024-W48">2024-W48 (11/25~12/01)</option>
                </select>

                <label style="display: inline-flex; align-items: center; gap: 0.5rem; cursor: pointer; font-size: 0.85rem; color: #666; font-weight: 500; margin-bottom: 0;">
                    <input type="checkbox" id="myBranchOnly" onchange="applyFilters()" style="width: 16px; height: 16px; cursor: pointer; accent-color: #1976d2;">
                    ë‚´ ì§€ì ë§Œ ë³´ê¸°
                </label>
            </div>

            <div class="product-tabs">
                <div class="product-tabs-label">ìƒí’ˆëª…</div>
                <div class="tabs-container" id="productTabs">
                </div>
            </div>

            <div class="total-count">ì´ <span id="totalCount">0</span>ê°œ í•­ëª©</div>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Left Column - Table -->
            <div class="left-column">
                <div class="table-wrapper">
                    <table id="productStatsTable">
                        <thead>
                            <tr>
                                <th>ìƒí’ˆë‚´ìˆœìœ„</th>
                                <th>ìƒí’ˆëª…</th>
                                <th>ë³¸ë¶€ëª…</th>
                                <th>ì§€ì ëª…</th>
                                <th>ì‹ ê·œê±´ìˆ˜</th>
                            </tr>
                        </thead>
                        <tbody id="productStatsBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Right Column - Details -->
            <div class="right-column">
                <!-- Know-how Section -->
                <div class="detail-section">
                    <div class="detail-header">
                        <div class="detail-title"><span class="emoji">ğŸ“</span> ì˜ì—… ë…¸í•˜ìš°</div>
                        <div class="detail-meta" id="knowhowMeta">ì„ íƒëœ í•­ëª© ì—†ìŒ</div>
                    </div>
                    <div class="detail-content" id="knowhowContent">
                    </div>
                </div>

                <!-- Customer Stats Section -->
                <div class="detail-section">
                    <div class="detail-header">
                        <div class="detail-title"><span class="emoji">ğŸ“Š</span> ìƒí’ˆ ê³ ê° í†µê³„</div>
                        <div class="detail-meta" id="statsMeta">ì„ íƒëœ ìƒí’ˆ ì—†ìŒ</div>
                    </div>
                    <div class="detail-content">
                        <div class="stats-selector">
                            <select id="statsType" onchange="updateStatsView()">
                                <option value="age">ì—°ë ¹ëŒ€ë³„</option>
                                <option value="gender">ì„±ë³„</option>
                                <option value="occupation">ì§ì—…ë³„</option>
                                <option value="balance">ìˆ˜ì‹ í‰ì”ë³„</option>
                                <option value="asset">ìì‚°ê·œëª¨ë³„</option>
                                <option value="region">ê±°ì£¼ì§€ì—­ë³„</option>
                            </select>
                        </div>
                        <div class="stats-grid" id="statsGrid">
                        </div>
                    </div>
                </div>

                <!-- Target List Section -->
                <div class="detail-section">
                    <div class="detail-header">
                        <div class="detail-title"><span class="emoji">ğŸ¯</span> ê´€ë ¨ íƒ€ê²Ÿ ë¦¬ìŠ¤íŠ¸</div>
                        <div class="detail-meta" id="targetMeta">ì„ íƒëœ ìƒí’ˆ ì—†ìŒ</div>
                    </div>
                    <div class="target-list-wrapper">
                        <div id="targetListContainer">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Know-how Write/Edit Modal -->
    <div id="writeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ì˜ì—…ë…¸í•˜ìš° ë“±ë¡/ìˆ˜ì •</h2>
                <button class="modal-close" onclick="closeModal('writeModal')">&times;</button>
            </div>
            <div class="modal-subtitle">
                <span id="modalBranchInfo"></span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ì˜ì—… ë…¸í•˜ìš°</label>
                    <textarea class="form-textarea" id="knowhowText" placeholder="ì˜ì—… ë…¸í•˜ìš°ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    <div class="char-count"><span id="charCount">0</span> / 1,000ì</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal('writeModal')">ë‹«ê¸°</button>
                <button class="btn btn-primary" onclick="saveKnowHow()">ì ìš©</button>
            </div>
        </div>
    </div>

    <!-- Extract Modal -->
    <div id="extractModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">íƒ€ê²Ÿ ë¦¬ìŠ¤íŠ¸ ì¶”ì¶œ</h2>
                <button class="modal-close" onclick="closeModal('extractModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ë¦¬ìŠ¤íŠ¸ëª…</label>
                    <div id="extractListTitle" style="padding: 0.875rem 1rem; background: var(--gray-100); border: 2px solid var(--gray-300);"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">ì˜ˆìƒ ëŒ€ìƒ ê³ ê° ìˆ˜</label>
                    <div id="extractListCount" style="padding: 0.875rem 1rem; background: var(--gray-100); border: 2px solid var(--gray-300); font-family: 'JetBrains Mono', monospace; font-weight: 600;"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">íŒŒì¼ í˜•ì‹</label>
                    <select class="form-input" id="extractFormat">
                        <option value="xlsx">Excel (XLSX)</option>
                        <option value="csv">CSV</option>
                        <option value="json">JSON</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">í¬í•¨ ì •ë³´</label>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem; padding: 0.5rem 0;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" checked> ê³ ê°ëª…
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" checked> ì—°ë½ì²˜
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" checked> AI ì‹ ê·œê°€ì… ì˜ˆì¸¡í™•ë¥ 
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" checked> ê³ ê° íŠ¹ì„± ë¶„ì„
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox"> ê±°ë˜ ì´ë ¥
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal('extractModal')">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="confirmExtract()">ì¶”ì¶œí•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        // Sample data - same structure as before
        const allData = [
            // ì „ì„¤ì˜ì ê¸ˆ
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 45, productRank: 1, groupRank: 1, knowhow: `ğŸ¯ ì£¼ìš” íƒ€ê²Ÿ ê³ ê°

20ëŒ€ í›„ë°˜~30ëŒ€ ì´ˆë°˜ ì‚¬íšŒì´ˆë…„ìƒ (ì…ì‚¬ 3~7ë…„ì°¨)
ì›”ê¸‰ 300~500ë§Œì› ì§ì¥ì¸ ì¤‘ ëª©ëˆ ë§ˆë ¨ ëª©ì  ê³ ê°

ğŸ”„ ì „í™˜ í¬ì¸íŠ¸ / ì„¤ë“ ë…¼ë¦¬

"ì§€ê¸ˆ ê¸ˆë¦¬ê°€ ì œì¼ ë†’ì„ ë•Œ"ë¼ëŠ” íƒ€ì´ë° ê°•ì¡°
3ë…„ ë’¤ ëª©ëˆ(ê²°í˜¼ìê¸ˆ, ì „ì„¸ìê¸ˆ) í•„ìš” ì‹œì ê³¼ ë§Œê¸° ì¼ì¹˜

ğŸ—£ï¸ ì‹¤ì œ ì‚¬ìš© ì˜ì—… ë©˜íŠ¸

"ê³¼ì¥ë‹˜, ì§€ê¸ˆì´ ì ê¸ˆ ë“¤ê¸° ë”± ì¢‹ì€ íƒ€ì´ë°ì…ë‹ˆë‹¤.
ê¸ˆë¦¬ 4.5% í™•ì •ì´ê³ , ì›” 50ë§Œì›ì”© 3ë…„ í•˜ì‹œë©´ 2ì²œë§Œì› ëª¨ìœ¼ì„¸ìš”.
ê²°í˜¼ ì¤€ë¹„í•˜ì‹ ë‹¤ê³  í•˜ì…¨ì–ì•„ìš”. ë”± ë§ì¶°ì„œ ëª©ëˆ ë§Œë“œì‹¤ ìˆ˜ ìˆì–´ìš”."` },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 42, productRank: 2, groupRank: 2, knowhow: `ğŸ¯ ì£¼ìš” íƒ€ê²Ÿ ê³ ê°

ì§€í•˜ì² ì—­ ì¸ê·¼ ì§ì¥ì¸ (ì ì‹¬ì‹œê°„ ìœ ë™ì¸êµ¬ í™œìš©)
20~30ëŒ€ SNS í™œìš© ì„¸ëŒ€

ğŸ”„ ì „í™˜ í¬ì¸íŠ¸ / ì„¤ë“ ë…¼ë¦¬

ì ì‹¬ì‹œê°„ ë¶€ìŠ¤ì—ì„œ "5ë¶„ì´ë©´ ê°€ì… ë" í¸ë¦¬ì„± ê°•ì¡°
ì²« ë‹¬ ìš°ëŒ€ê¸ˆë¦¬ ì´ë²¤íŠ¸ë¡œ ì¦‰ì‹œ í˜œíƒ ì²´ê°

ğŸ—£ï¸ ì‹¤ì œ ì‚¬ìš© ì˜ì—… ë©˜íŠ¸

"ì ì‹¬ ë“œì‹œëŸ¬ ê°€ì‹œëŠ” ê¸¸ì— 5ë¶„ë§Œ ì‹œê°„ ë‚´ì£¼ì„¸ìš”.
ì´ë²ˆ ë‹¬ ê°€ì…í•˜ì‹œë©´ ì²« ë‹¬ ê¸ˆë¦¬ 0.5% ë” ë“œë¦½ë‹ˆë‹¤.
ì•±ìœ¼ë¡œ ë°”ë¡œ ê°€ì…ë˜ë‹ˆê¹Œ ì•‰ì•„ì„œ ì»¤í”¼ í•œ ì” í•˜ì‹œëŠ” ë™ì•ˆ ëë‚˜ìš”."` },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 39, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 36, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 33, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 30, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 27, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 24, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì˜ë“±í¬ì§€ì ', count: 21, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ì „ì„¤ì˜ì ê¸ˆ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 18, productRank: 10, groupRank: 10, knowhow: '' },

            // ê°œì¸í˜• IRP
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 38, productRank: 1, groupRank: 1, knowhow: `ğŸ¯ ì£¼ìš” íƒ€ê²Ÿ ê³ ê°

40~50ëŒ€ ì¤‘ê²¬ê¸°ì—… ì¬ì§ ì§ì¥ì¸ (ì—°ë´‰ 6ì²œ~1ì–µ)
ê°œì¸ì‚¬ì—…ì ì¤‘ ì„¸ë¬´ì‚¬ í†µí•œ ì ˆì„¸ ìƒë‹´ ë°›ì€ ê³ ê°

ğŸ”„ ì „í™˜ í¬ì¸íŠ¸ / ì„¤ë“ ë…¼ë¦¬

"ì—°ë§ì •ì‚° ë•Œ ì„¸ì•¡ê³µì œ 900ë§Œì›ê¹Œì§€ ë°›ì„ ìˆ˜ ìˆë‹¤"ëŠ” ì¦‰ê°ì  í˜œíƒ ê°•ì¡°
í‡´ì§ê¸ˆì„ IRPë¡œ ë°›ìœ¼ë©´ ì„¸ê¸ˆ ì´ì—° íš¨ê³¼ë¡œ ëª©ëˆ ìœ ì§€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì 

ğŸ—£ï¸ ì‹¤ì œ ì‚¬ìš© ì˜ì—… ë©˜íŠ¸

"ê³¼ì¥ë‹˜, ë‚´ë…„ 2ì›” ì—°ë§ì •ì‚° ë•Œ í™˜ê¸‰ê¸ˆ ìµœëŒ€ 148ë§Œì› ë” ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì›” 50ë§Œì›ì”©ë§Œ IRP ë„£ìœ¼ì‹œë©´ 1ë…„ì— ì„¸ê¸ˆ 90ë§Œì› ëŒë ¤ë°›ìœ¼ì„¸ìš”.
í‡´ì§ê¸ˆ ë‚˜ì˜¤ë©´ ì—¬ê¸°ë¡œ ë°›ìœ¼ì‹œë©´ ì„¸ê¸ˆ ì•ˆ ë–¼ê³  í†µì§¸ë¡œ êµ´ë¦¬ì‹¤ ìˆ˜ ìˆì–´ìš”."` },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 35, productRank: 2, groupRank: 2, knowhow: `ğŸ¯ ì£¼ìš” íƒ€ê²Ÿ ê³ ê°

30ëŒ€ í›„ë°˜~40ëŒ€ ì´ˆë°˜ ìŠ¤íƒ€íŠ¸ì—…Â·IT ê¸°ì—… ì¬ì§ì
ì—°ë´‰ 8ì²œ ì´ìƒ ê³ ì†Œë“ ì „ë¬¸ì§ (ì˜ì‚¬, ë³€í˜¸ì‚¬, íšŒê³„ì‚¬)

ğŸ”„ ì „í™˜ í¬ì¸íŠ¸ / ì„¤ë“ ë…¼ë¦¬

"ì—°ê¸ˆì €ì¶• + IRP í•©ì³ì„œ ìµœëŒ€ 900ë§Œì› ì„¸ì•¡ê³µì œ" ì •ë³´ì— ê´€ì‹¬ ì „í™˜
ìŠ¤í†¡ì˜µì…˜Â·ì„±ê³¼ê¸‰ ë°›ì„ ë•Œ ì„¸ê¸ˆ ë¶€ë‹´ â†’ IRPë¡œ ì ˆì„¸ ê°€ëŠ¥

ğŸ—£ï¸ ì‹¤ì œ ì‚¬ìš© ì˜ì—… ë©˜íŠ¸

"ì§€ê¸ˆ ì—°ê¸ˆì €ì¶• í•˜ê³  ê³„ì‹œì£ ? ê±°ê¸°ì— 300ë§Œì› ë” ë„£ìœ¼ì‹¤ ìˆ˜ ìˆì–´ìš”.
í•©ì³ì„œ 900ë§Œì›ê¹Œì§€ ì„¸ì•¡ê³µì œ ë˜ë‹ˆê¹Œ ì‹¤ì œë¡œ 148ë§Œì› í™˜ê¸‰ë°›ìœ¼ì„¸ìš”.
ì„±ê³¼ê¸‰ ë°›ìœ¼ì‹¤ ë•Œ ì„¸ê¸ˆ ì•„ê¹Œìš°ì‹œë©´ ì—¬ê¸° ë„£ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤."` },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 32, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 29, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 26, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 23, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 20, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 17, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì˜ë“±í¬ì§€ì ', count: 14, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'IRP', product: 'ê°œì¸í˜• IRP', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 11, productRank: 10, groupRank: 10, knowhow: '' },

            // í”„ë¦¬ë¯¸ì—„ì ê¸ˆ
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 32, productRank: 1, groupRank: 1, knowhow: `ğŸ¯ ì£¼ìš” íƒ€ê²Ÿ ê³ ê°

ìì‚° 5ì–µ ì´ìƒ ë³´ìœ  ìì‚°ê°€ (ë¶€ë™ì‚° 2ì±„ ì´ìƒ)
40~50ëŒ€ ê¸°ì—… ì„ì›ê¸‰ / ê°œì¸ì‚¬ì—… ì„±ê³µí•œ ëŒ€í‘œ

ğŸ”„ ì „í™˜ í¬ì¸íŠ¸ / ì„¤ë“ ë…¼ë¦¬

"í”„ë¦¬ë¯¸ì—„ ê³ ê° ì „ìš© íŠ¹ë³„ê¸ˆë¦¬"ë¼ëŠ” VIP ëŒ€ìš° ì¸ì‹
ë¬¸í™”ì˜ˆìˆ  ê³µì—° ì´ˆëŒ€ê¶Œ, ê³¨í”„ì¥ ìš°ëŒ€ ë“± ë¶€ê°€ì„œë¹„ìŠ¤

ğŸ—£ï¸ ì‹¤ì œ ì‚¬ìš© ì˜ì—… ë©˜íŠ¸

"ëŒ€í‘œë‹˜, ì´ ìƒí’ˆì€ ìì‚° 5ì–µ ì´ìƒ ê³ ê°ë‹˜ë§Œ ê°€ì… ê°€ëŠ¥í•©ë‹ˆë‹¤.
ì¼ë°˜ ì ê¸ˆë³´ë‹¤ ê¸ˆë¦¬ 1% ë” ë†’ê³ , êµ­ë¦½ê·¹ì¥ VIPì„ ì´ˆëŒ€ê¶Œë„ ë“œë¦½ë‹ˆë‹¤.
ëª©ëˆ êµ´ë¦¬ì‹œë©´ì„œ ì„¸ê¸ˆ í˜œíƒë„ ë°›ìœ¼ì‹œê³ , ë¬¸í™”ìƒí™œë„ ì¦ê¸°ì„¸ìš”."` },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 28, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 25, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 22, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 19, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 16, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 13, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 10, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 7, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì˜ë“±í¬ì§€ì ', count: 4, productRank: 10, groupRank: 10, knowhow: '' },

            // ììœ ì ê¸ˆ
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 28, productRank: 1, groupRank: 1, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 25, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 22, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 19, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 16, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 13, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 10, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 7, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 4, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'ì ê¸ˆ', product: 'ììœ ì ê¸ˆ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 2, productRank: 10, groupRank: 10, knowhow: '' },

            // ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 26, productRank: 1, groupRank: 1, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 23, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 20, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 17, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 14, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 11, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 8, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 5, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 3, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 2, productRank: 10, groupRank: 10, knowhow: '' },

            // ì •ê¸°ì˜ˆê¸ˆ
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 24, productRank: 1, groupRank: 1, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 21, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 18, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 15, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 12, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 9, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 6, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 4, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 3, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'ì˜ˆê¸ˆ', product: 'ì •ê¸°ì˜ˆê¸ˆ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 2, productRank: 10, groupRank: 10, knowhow: '' },

            // ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 22, productRank: 1, groupRank: 1, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 19, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 16, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 13, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 10, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 7, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 5, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 4, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 3, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 2, productRank: 10, groupRank: 10, knowhow: '' },

            // êµ­ë‚´ì£¼ì‹í˜•í€ë“œ
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 20, productRank: 1, groupRank: 1, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 17, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 14, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 11, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 8, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 6, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 5, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 4, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 3, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 2, productRank: 10, groupRank: 10, knowhow: '' },

            // ì±„ê¶Œí˜•í€ë“œ
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 18, productRank: 1, groupRank: 1, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 15, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 12, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 9, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 6, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 5, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 4, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 3, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 2, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'í€ë“œ', product: 'ì±„ê¶Œí˜•í€ë“œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 1, productRank: 10, groupRank: 10, knowhow: '' },

            // ì£¼íƒë‹´ë³´ëŒ€ì¶œ
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ë¶„ë‹¹ì§€ì ', count: 30, productRank: 1, groupRank: 1, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ê²½ê¸°ë³¸ë¶€', branch: 'ê°•ë‚¨ì§€ì ', count: 27, productRank: 2, groupRank: 2, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ì„œë¶€ë³¸ë¶€', branch: 'ì‹ ë„ë¦¼ì§€ì ', count: 24, productRank: 3, groupRank: 3, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ê²½ë‚¨ë³¸ë¶€', branch: 'ë¶€ì‚°ì§€ì ', count: 21, productRank: 4, groupRank: 4, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì„œì†Œë¬¸ì§€ì ', count: 18, productRank: 5, groupRank: 5, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'í˜¸ë‚¨ë³¸ë¶€', branch: 'ê´‘ì£¼ì§€ì ', count: 15, productRank: 6, groupRank: 6, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ì¶©ë‚¨ë³¸ë¶€', branch: 'ëŒ€ì „ì§€ì ', count: 12, productRank: 7, groupRank: 7, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ê²½ë¶ë³¸ë¶€', branch: 'ëŒ€êµ¬ì§€ì ', count: 9, productRank: 8, groupRank: 8, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ê°•ì›ë³¸ë¶€', branch: 'ì¶˜ì²œì§€ì ', count: 6, productRank: 9, groupRank: 9, knowhow: '' },
            { week: '2024-W49', group: 'ëŒ€ì¶œ', product: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ', region: 'ì¤‘ë¶€ë³¸ë¶€', branch: 'ì¢…ë¡œì§€ì ', count: 3, productRank: 10, groupRank: 10, knowhow: '' },
        ];

        // Customer statistics data (same as before - abbreviated for space)
        const customerStats = {
            'ì „ì„¤ì˜ì ê¸ˆ': {
                age: [
                    { label: '10ëŒ€~20ëŒ€', value: 8, percent: 10.7 },
                    { label: '20ëŒ€~30ëŒ€', value: 18, percent: 24.0 },
                    { label: '30ëŒ€~40ëŒ€', value: 23, percent: 30.7 },
                    { label: '40ëŒ€~50ëŒ€', value: 15, percent: 20.0 },
                    { label: '50ëŒ€~60ëŒ€', value: 9, percent: 12.0 },
                    { label: '60ëŒ€ ì´ìƒ', value: 2, percent: 2.7 }
                ],
                gender: [
                    { label: 'ë‚¨ì„±', value: 42, percent: 56.0 },
                    { label: 'ì—¬ì„±', value: 33, percent: 44.0 }
                ],
                occupation: [
                    { label: 'ì§ì¥ì¸', value: 35, percent: 46.7 },
                    { label: 'ê°œì¸ì‚¬ì—…ì', value: 18, percent: 24.0 },
                    { label: 'ì „ë¬¸ì§', value: 12, percent: 16.0 },
                    { label: 'ìì˜ì—…', value: 6, percent: 8.0 },
                    { label: 'ê¸°íƒ€', value: 4, percent: 5.3 }
                ],
                balance: [
                    { label: '100ë§Œì› ì´í•˜', value: 15, percent: 20.0 },
                    { label: '100ë§Œì›~300ë§Œì›', value: 22, percent: 29.3 },
                    { label: '300ë§Œì›~500ë§Œì›', value: 18, percent: 24.0 },
                    { label: '500ë§Œì›~1000ë§Œì›', value: 12, percent: 16.0 },
                    { label: '1000ë§Œì› ì´ˆê³¼', value: 8, percent: 10.7 }
                ],
                asset: [
                    { label: '5ì²œë§Œì› ì´í•˜', value: 28, percent: 37.3 },
                    { label: '5ì²œë§Œì›~1ì–µ', value: 25, percent: 33.3 },
                    { label: '1ì–µ~3ì–µ', value: 15, percent: 20.0 },
                    { label: '3ì–µ ì´ˆê³¼', value: 7, percent: 9.3 }
                ],
                region: [
                    { label: 'ì„œìš¸', value: 32, percent: 42.7 },
                    { label: 'ê²½ê¸°', value: 28, percent: 37.3 },
                    { label: 'ì¸ì²œ', value: 8, percent: 10.7 },
                    { label: 'ê¸°íƒ€', value: 7, percent: 9.3 }
                ]
            },
            'ê°œì¸í˜• IRP': {
                age: [
                    { label: '10ëŒ€~20ëŒ€', value: 2, percent: 2.9 },
                    { label: '20ëŒ€~30ëŒ€', value: 15, percent: 22.1 },
                    { label: '30ëŒ€~40ëŒ€', value: 28, percent: 41.2 },
                    { label: '40ëŒ€~50ëŒ€', value: 18, percent: 26.5 },
                    { label: '50ëŒ€~60ëŒ€', value: 5, percent: 7.4 }
                ],
                gender: [
                    { label: 'ë‚¨ì„±', value: 45, percent: 66.2 },
                    { label: 'ì—¬ì„±', value: 23, percent: 33.8 }
                ],
                occupation: [
                    { label: 'ì§ì¥ì¸', value: 52, percent: 76.5 },
                    { label: 'ì „ë¬¸ì§', value: 8, percent: 11.8 },
                    { label: 'ê°œì¸ì‚¬ì—…ì', value: 6, percent: 8.8 },
                    { label: 'ê¸°íƒ€', value: 2, percent: 2.9 }
                ],
                balance: [
                    { label: '100ë§Œì› ì´í•˜', value: 3, percent: 4.4 },
                    { label: '100ë§Œì›~500ë§Œì›', value: 12, percent: 17.6 },
                    { label: '500ë§Œì›~1000ë§Œì›', value: 28, percent: 41.2 },
                    { label: '1000ë§Œì›~3000ë§Œì›', value: 18, percent: 26.5 },
                    { label: '3000ë§Œì› ì´ˆê³¼', value: 7, percent: 10.3 }
                ],
                asset: [
                    { label: '5ì²œë§Œì› ì´í•˜', value: 8, percent: 11.8 },
                    { label: '5ì²œë§Œì›~1ì–µ', value: 15, percent: 22.1 },
                    { label: '1ì–µ~3ì–µ', value: 28, percent: 41.2 },
                    { label: '3ì–µ~5ì–µ', value: 12, percent: 17.6 },
                    { label: '5ì–µ ì´ˆê³¼', value: 5, percent: 7.4 }
                ],
                region: [
                    { label: 'ì„œìš¸', value: 38, percent: 55.9 },
                    { label: 'ê²½ê¸°', value: 22, percent: 32.4 },
                    { label: 'ì¸ì²œ', value: 5, percent: 7.4 },
                    { label: 'ê¸°íƒ€', value: 3, percent: 4.4 }
                ]
            },
            // Add default stats for other products
            'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ': { age: [{ label: '30ëŒ€~40ëŒ€', value: 18, percent: 42.9 }], gender: [{ label: 'ë‚¨ì„±', value: 24, percent: 57.1 }, { label: 'ì—¬ì„±', value: 18, percent: 42.9 }], occupation: [{ label: 'ì „ë¬¸ì§', value: 18, percent: 42.9 }], balance: [{ label: '1000ë§Œì›~3000ë§Œì›', value: 18, percent: 42.9 }], asset: [{ label: '3ì–µ~5ì–µ', value: 18, percent: 42.9 }], region: [{ label: 'ì„œìš¸ ê°•ë‚¨', value: 22, percent: 52.4 }] },
            'ììœ ì ê¸ˆ': { age: [{ label: '20ëŒ€~30ëŒ€', value: 22, percent: 45.8 }], gender: [{ label: 'ë‚¨ì„±', value: 26, percent: 54.2 }, { label: 'ì—¬ì„±', value: 22, percent: 45.8 }], occupation: [{ label: 'ì§ì¥ì¸', value: 25, percent: 52.1 }], balance: [{ label: '50ë§Œì› ì´í•˜', value: 22, percent: 45.8 }], asset: [{ label: '1ì²œë§Œì› ì´í•˜', value: 25, percent: 52.1 }], region: [{ label: 'ê²½ê¸°', value: 22, percent: 45.8 }] },
            'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•': { age: [{ label: '20ëŒ€~30ëŒ€', value: 35, percent: 56.5 }], gender: [{ label: 'ë‚¨ì„±', value: 38, percent: 61.3 }, { label: 'ì—¬ì„±', value: 24, percent: 38.7 }], occupation: [{ label: 'ì§ì¥ì¸', value: 48, percent: 77.4 }], balance: [{ label: '300ë§Œì›~500ë§Œì›', value: 28, percent: 45.2 }], asset: [{ label: '5ì²œë§Œì›~1ì–µ', value: 28, percent: 45.2 }], region: [{ label: 'ê²½ê¸°', value: 30, percent: 48.4 }] },
            'ì •ê¸°ì˜ˆê¸ˆ': { age: [{ label: '50ëŒ€~60ëŒ€', value: 18, percent: 40.9 }], gender: [{ label: 'ë‚¨ì„±', value: 26, percent: 59.1 }, { label: 'ì—¬ì„±', value: 18, percent: 40.9 }], occupation: [{ label: 'ì€í‡´ì', value: 22, percent: 50.0 }], balance: [{ label: '1000ë§Œì›~3000ë§Œì›', value: 18, percent: 40.9 }], asset: [{ label: '1ì–µ~3ì–µ', value: 20, percent: 45.5 }], region: [{ label: 'ê²½ê¸°', value: 18, percent: 40.9 }] },
            'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ': { age: [{ label: '30ëŒ€~40ëŒ€', value: 15, percent: 42.9 }], gender: [{ label: 'ë‚¨ì„±', value: 25, percent: 71.4 }, { label: 'ì—¬ì„±', value: 10, percent: 28.6 }], occupation: [{ label: 'ì§ì¥ì¸', value: 18, percent: 51.4 }], balance: [{ label: '3000ë§Œì›~5000ë§Œì›', value: 15, percent: 42.9 }], asset: [{ label: '3ì–µ~5ì–µ', value: 15, percent: 42.9 }], region: [{ label: 'ì„œìš¸ ê°•ë‚¨', value: 20, percent: 57.1 }] },
            'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ': { age: [{ label: '30ëŒ€~40ëŒ€', value: 12, percent: 44.4 }], gender: [{ label: 'ë‚¨ì„±', value: 18, percent: 66.7 }, { label: 'ì—¬ì„±', value: 9, percent: 33.3 }], occupation: [{ label: 'ì§ì¥ì¸', value: 20, percent: 74.1 }], balance: [{ label: '1000ë§Œì›~3000ë§Œì›', value: 12, percent: 44.4 }], asset: [{ label: '1ì–µ~3ì–µ', value: 14, percent: 51.9 }], region: [{ label: 'ì„œìš¸', value: 12, percent: 44.4 }] },
            'ì±„ê¶Œí˜•í€ë“œ': { age: [{ label: '50ëŒ€~60ëŒ€', value: 10, percent: 45.5 }], gender: [{ label: 'ë‚¨ì„±', value: 13, percent: 59.1 }, { label: 'ì—¬ì„±', value: 9, percent: 40.9 }], occupation: [{ label: 'ì€í‡´ì', value: 10, percent: 45.5 }], balance: [{ label: '3000ë§Œì›~5000ë§Œì›', value: 10, percent: 45.5 }], asset: [{ label: '3ì–µ~5ì–µ', value: 10, percent: 45.5 }], region: [{ label: 'ì„œìš¸', value: 10, percent: 45.5 }] },
            'ì£¼íƒë‹´ë³´ëŒ€ì¶œ': { age: [{ label: '30ëŒ€~40ëŒ€', value: 25, percent: 49.0 }], gender: [{ label: 'ë‚¨ì„±', value: 35, percent: 68.6 }, { label: 'ì—¬ì„±', value: 16, percent: 31.4 }], occupation: [{ label: 'ì§ì¥ì¸', value: 38, percent: 74.5 }], balance: [{ label: '1000ë§Œì›~3000ë§Œì›', value: 25, percent: 49.0 }], asset: [{ label: '3ì–µ~5ì–µ', value: 22, percent: 43.1 }], region: [{ label: 'ê²½ê¸°', value: 28, percent: 54.9 }] }
        };

        // Target lists (same as before - abbreviated)
        const targetLists = {
            'ì „ì„¤ì˜ì ê¸ˆ': [
                { id: 1, title: 'ì „ì„¤ì˜ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (20~30ëŒ€ ì§ì¥ì¸ ëŒ€ìƒ)', count: 1247, aiScore: 92, desc: 'ìµœê·¼ 6ê°œì›” ë‚´ ê¸‰ì—¬ì´ì²´ê°€ ì‹œì‘ëœ 2030 ì§ì¥ì¸ìœ¼ë¡œ ê¸‰ì—¬ ì…ê¸ˆ í›„ ì”ì•¡ì´ ì¼ì • ìˆ˜ì¤€ ì´ìƒ ìœ ì§€ë˜ì–´ ì ê¸ˆ ê°€ì… ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°' },
                { id: 2, title: 'ì „ì„¤ì˜ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ê°œì¸ì‚¬ì—…ì ëŒ€ìƒ)', count: 856, aiScore: 88, desc: 'ì‚¬ì—…ìí†µì¥ ìš´ì˜ ì¤‘ì´ë‚˜ ê°œì¸ ì €ì¶• ìƒí’ˆì´ ì—†ìœ¼ë©° ë§¤ì¶œ ì•ˆì •ì„±ì´ í™•ì¸ëœ ìì˜ì—…ì' },
                { id: 3, title: 'ì „ì„¤ì˜ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ë¯¸ì„±ë…„ì ëŒ€ìƒ)', count: 423, aiScore: 85, desc: 'ë¶€ëª¨ê°€ ìš°ë¦¬ ì€í–‰ ì£¼ê±°ë˜ ê³ ê°ì´ë©° ìš©ëˆê´€ë¦¬ ë° ê¸ˆìœµêµìœ¡ ëª©ì ìœ¼ë¡œ ì ê¸ˆ ê°œì„¤ ìˆ˜ìš”ê°€ ì˜ˆìƒë˜ëŠ” ìë…€' },
                { id: 4, title: 'ì „ì„¤ì˜ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (50~60ëŒ€ ì€í‡´ì¤€ë¹„ ëŒ€ìƒ)', count: 312, aiScore: 82, desc: 'ìµœê·¼ í‡´ì§ê¸ˆ ë˜ëŠ” ëª©ëˆì´ ì…ê¸ˆë˜ì—ˆìœ¼ë‚˜ ì¦‰ì‹œ ì¸ì¶œí•˜ì§€ ì•Šê³  ì•ˆì •ì  ì´ì ìˆ˜ìµì„ ì›í•˜ëŠ” ë³´ìˆ˜ì  íˆ¬ì ì„±í–¥ ê³ ê°' }
            ],
            'ê°œì¸í˜• IRP': [
                { id: 7, title: 'ê°œì¸í˜• IRP ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (30~40ëŒ€ ê³ ì†Œë“ì)', count: 2134, aiScore: 95, desc: 'ì—°ì†Œë“ 8ì²œë§Œì› ì´ìƒìœ¼ë¡œ ì¶”ì •ë˜ë©° ì—°ë§ì •ì‚° ì„¸ì•¡ê³µì œ í˜œíƒì— ë¯¼ê°í•˜ì—¬ ì ˆì„¸ ìƒí’ˆ ê°€ì… ì˜í–¥ì´ ë†’ì€ ê³ ê°' },
                { id: 8, title: 'ê°œì¸í˜• IRP ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ì „ë¬¸ì§êµ° ëŒ€ìƒ)', count: 1567, aiScore: 91, desc: 'ì˜ì‚¬, ë³€í˜¸ì‚¬, íšŒê³„ì‚¬ ë“± ë©´í—ˆì¦ ê¸°ë°˜ ì „ë¬¸ì§ ì¢…ì‚¬ìë¡œ ë†’ì€ ì†Œë“ ëŒ€ë¹„ ë…¸í›„ ì¤€ë¹„ ë‹ˆì¦ˆê°€ í° ê³ ê°' },
                { id: 9, title: 'ê°œì¸í˜• IRP ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ITì—…ì¢… ì¢…ì‚¬ì)', count: 892, aiScore: 87, desc: 'ì£¼ìš” IT/í…Œí¬ ê¸°ì—… ì¬ì§ìë¡œ ìŠ¤í†¡ì˜µì…˜ ë° ì„±ê³¼ê¸‰ ìˆ˜ë ¹ ì‹œ ì ˆì„¸ ë°©ì•ˆì„ ì°¾ëŠ” ê³ ê°' }
            ],
            'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ': [
                { id: 12, title: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ê³ ì•¡ìì‚°ê°€)', count: 567, aiScore: 94, desc: 'ë³´ìœ  ê¸ˆìœµìì‚°ì´ 3ì–µì› ì´ìƒì´ë©° ë‹¤ìˆ˜ì˜ ë¶€ë™ì‚° ë³´ìœ ê°€ ì¶”ì •ë˜ëŠ” VIP ì „ìš© ìƒí’ˆ ì í•© ê³ ê°' },
                { id: 13, title: 'í”„ë¦¬ë¯¸ì—„ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (VIP ê³ ê° ëŒ€ìƒ)', count: 234, aiScore: 96, desc: 'PB ì„¼í„° ê´€ë¦¬ ì¤‘ì¸ ìš°ëŒ€ ê³ ê°ìœ¼ë¡œ ìì‚° í¬íŠ¸í´ë¦¬ì˜¤ ë‹¤ê°í™”ê°€ í•„ìš”í•œ ì‹œì ì˜ ê³ ê°' }
            ],
            'ììœ ì ê¸ˆ': [
                { id: 16, title: 'ììœ ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (20ëŒ€ ì‚¬íšŒì´ˆë…„ìƒ)', count: 1893, aiScore: 88, desc: 'ì…ì‚¬ 3ë…„ ì´ë‚´ ì‹ ì…ì‚¬ì›ìœ¼ë¡œ ê¸‰ì—¬ ëŒ€ë¹„ ì €ì¶• ì—¬ë ¥ì€ ìˆìœ¼ë‚˜ ì •ê¸°ì ê¸ˆ ë‚©ì… ë¶€ë‹´ì„ ëŠë¼ëŠ” ê³ ê°' },
                { id: 17, title: 'ììœ ì ê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ëŒ€í•™ìƒ)', count: 1456, aiScore: 85, desc: 'í•™ìê¸ˆëŒ€ì¶œ ë³´ìœ  ë˜ëŠ” í•™ìƒì¦ ì¸ì¦ ì´ë ¥ì´ ìˆìœ¼ë©° ì•„ë¥´ë°”ì´íŠ¸ ìˆ˜ì…ì„ ì†Œì•¡ ì €ì¶•í•  ìˆ˜ ìˆëŠ” ìœ ì—°í•œ ìƒí’ˆ ë‹ˆì¦ˆê°€ ìˆëŠ” ê³ ê°' }
            ],
            'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•': [
                { id: 20, title: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶• ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ì‹ í˜¼ë¶€ë¶€)', count: 2456, aiScore: 94, desc: 'ìµœê·¼ 2ë…„ ë‚´ í˜¼ì¸ì‹ ê³ ê°€ í™•ì¸ë˜ë©° ìƒì•  ìµœì´ˆ ì£¼íƒ êµ¬ì… ê³„íš ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ì€ ì²­ì•½í†µì¥ ë¯¸ë³´ìœ  ê³ ê°' },
                { id: 21, title: 'ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶• ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (30ëŒ€ ë¬´ì£¼íƒì)', count: 3124, aiScore: 92, desc: 'ì£¼íƒ ë³´ìœ  ì´ë ¥ì´ ì—†ê³  ì „ì„¸ìê¸ˆëŒ€ì¶œ ë˜ëŠ” ì›”ì„¸ ì´ì²´ íŒ¨í„´ì´ í™•ì¸ë˜ì–´ ë‚´ì§‘ ë§ˆë ¨ ëª©í‘œê°€ ëª…í™•í•œ 30ëŒ€ ê³ ê°' }
            ],
            'ì •ê¸°ì˜ˆê¸ˆ': [
                { id: 24, title: 'ì •ê¸°ì˜ˆê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ì€í‡´ì)', count: 1834, aiScore: 91, desc: '60ëŒ€ ì´ìƒìœ¼ë¡œ ìµœê·¼ í‡´ì§ê¸ˆ ì…ê¸ˆì´ í™•ì¸ë˜ë©° ì•ˆì •ì  ì´ì ìˆ˜ìµì„ ì„ í˜¸í•˜ëŠ” ë³´ìˆ˜ì  ì„±í–¥ì˜ ìœ„í—˜ ìì‚° íšŒí”¼ ê³ ê°' },
                { id: 25, title: 'ì •ê¸°ì˜ˆê¸ˆ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ëª©ëˆ ë³´ìœ ì)', count: 1245, aiScore: 88, desc: 'ìµœê·¼ 3ê°œì›” ë‚´ 3ì²œë§Œì› ì´ìƒ ëª©ëˆì´ ì…ê¸ˆë˜ì—ˆìœ¼ë‚˜ íˆ¬ì ìƒí’ˆ ì—†ì´ ì…ì¶œê¸ˆ ê³„ì¢Œì—ë§Œ ë³´ê´€ ì¤‘ì¸ ë‹¨ê¸° ìê¸ˆ ìš´ìš© ê³„íš ë¶ˆë¶„ëª… ê³ ê°' }
            ],
            'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ': [
                { id: 28, title: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (í•´ì™¸íˆ¬ì ê´€ì‹¬ê³ ê°)', count: 1456, aiScore: 93, desc: 'ì™¸í™”ì˜ˆê¸ˆ ë³´ìœ  ë˜ëŠ” í•´ì™¸ì†¡ê¸ˆ ì´ë ¥ìœ¼ë¡œ ê¸€ë¡œë²Œ íˆ¬ì ê´€ì‹¬ë„ê°€ ë†’ìœ¼ë©° í™˜ìœ¨ ë³€ë™ ë¦¬ìŠ¤í¬ì— ëŒ€í•œ ì´í•´ë„ê°€ ìˆëŠ” ê³ ê°' },
                { id: 29, title: 'ê¸€ë¡œë²Œì£¼ì‹í˜•í€ë“œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ê³ ì•¡ ìì‚°ê°€)', count: 892, aiScore: 90, desc: 'íˆ¬ì ê°€ëŠ¥ ê¸ˆìœµìì‚° 1ì–µì› ì´ìƒì´ë©° ì´ë¯¸ êµ­ë‚´ ì£¼ì‹í˜• í€ë“œ ë³´ìœ  ì¤‘ì¸ í¬íŠ¸í´ë¦¬ì˜¤ ë‹¤ê°í™” í•„ìš” ê³ ê°' }
            ],
            'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ': [
                { id: 32, title: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ì£¼ì‹íˆ¬ì ì´ˆë³´ì)', count: 1723, aiScore: 89, desc: 'ì¦ê¶Œê³„ì¢Œ ë¯¸ë³´ìœ  ë˜ëŠ” ê±°ë˜ ì´ë ¥ì´ ê±°ì˜ ì—†ìœ¼ë©° ì§ì ‘ ì£¼ì‹ íˆ¬ìëŠ” ë¶€ë‹´ìŠ¤ëŸ¬ì›Œí•˜ë‚˜ ì „ë¬¸ê°€ ìš´ìš© í€ë“œë¥¼ í†µí•œ ê°„ì ‘ íˆ¬ìì— ê´€ì‹¬ ìˆëŠ” ê³ ê°' },
                { id: 33, title: 'êµ­ë‚´ì£¼ì‹í˜•í€ë“œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (30ëŒ€ ì§ì¥ì¸)', count: 1345, aiScore: 86, desc: 'ì•ˆì •ì  ê¸‰ì—¬ì†Œë“ì´ ìˆëŠ” 30ëŒ€ë¡œ ì›” 50~100ë§Œì› ì—¬ìœ  ìê¸ˆì´ í™•ì¸ë˜ë©° ì ê¸ˆ ì™¸ ì¶”ê°€ ìˆ˜ìµì„ ì›í•˜ëŠ” ê³ ê°' }
            ],
            'ì±„ê¶Œí˜•í€ë“œ': [
                { id: 36, title: 'ì±„ê¶Œí˜•í€ë“œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ë³´ìˆ˜ì  íˆ¬ìì)', count: 1567, aiScore: 90, desc: '50ëŒ€ ì´ìƒìœ¼ë¡œ ì£¼ì‹í˜• í€ë“œ ê²½í—˜ì´ ì—†ìœ¼ë©° ì˜ˆê¸ˆë³´ë‹¤ ì•½ê°„ ë†’ì€ ìˆ˜ìµì„ ì›í•˜ë‚˜ ì›ê¸ˆ ì†ì‹¤ ìœ„í—˜ì€ ìµœì†Œí™”í•˜ë ¤ëŠ” ê³ ê°' },
                { id: 37, title: 'ì±„ê¶Œí˜•í€ë“œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ì€í‡´ ì¤€ë¹„ì)', count: 1234, aiScore: 87, desc: 'ì€í‡´ 5ë…„ ì´ë‚´ë¡œ ì¶”ì •ë˜ë©° í‡´ì§ê¸ˆ ë° ì—°ê¸ˆ ìˆ˜ë ¹ ì¤€ë¹„ ì¤‘ì¸ ì•ˆì •ì  ì›”ë°°ë‹¹ ìƒí’ˆ ë‹ˆì¦ˆê°€ ëª…í™•í•œ ê³ ê°' }
            ],
            'ì£¼íƒë‹´ë³´ëŒ€ì¶œ': [
                { id: 40, title: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ì•„íŒŒíŠ¸ ì…ì£¼ ì˜ˆì •ì)', count: 2345, aiScore: 95, desc: 'ìµœê·¼ ì‹ ê·œ ì•„íŒŒíŠ¸ ë¶„ì–‘ ê³„ì•½ì´ í™•ì¸ë˜ë©° ì”ê¸ˆ ë‚©ë¶€ ì‹œì ì´ 3~6ê°œì›” ë‚´ ë„ë˜í•˜ì—¬ ëŒ€ì¶œ ì‹¤í–‰ ì‹œê¸°ê°€ ëª…í™•í•œ ê³ ê°' },
                { id: 41, title: 'ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì‹ ê·œ ê°€ë§ íƒ€ê²Ÿë¦¬ìŠ¤íŠ¸ (ì „ì„¸â†’ë§¤ë§¤ ì „í™˜)', count: 1876, aiScore: 92, desc: 'í˜„ì¬ ì „ì„¸ìê¸ˆëŒ€ì¶œ ë³´ìœ  ì¤‘ì´ë©° ìµœê·¼ ì£¼íƒ ë§¤ë§¤ ê´€ë ¨ ë¬¸ì˜ ë˜ëŠ” ë¶€ë™ì‚° ê±°ë˜ ì¡°íšŒ ì´ë ¥ì´ ìˆì–´ ìê°€ êµ¬ì… ì „í™˜ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°' }
            ]
        };

        let filteredData = [];
        let selectedProduct = '';
        let selectedBranch = '';
        let selectedWeek = '2024-W49';
        let currentProductFilter = '';

        // Initialize
        function initializeProductTabs() {
            const products = [...new Set(allData.map(item => item.product))];
            
            // Reorder products to put ê°œì¸í˜• IRP first
            const reorderedProducts = [];
            const irpProduct = 'ê°œì¸í˜• IRP';
            
            if (products.includes(irpProduct)) {
                reorderedProducts.push(irpProduct);
            }
            
            products.forEach(product => {
                if (product !== irpProduct) {
                    reorderedProducts.push(product);
                }
            });
            
            const tabsContainer = document.getElementById('productTabs');
            
            // Add "ì „ì²´" tab
            const allTab = document.createElement('a');
            allTab.className = 'tab';
            allTab.textContent = 'ì „ì²´';
            allTab.onclick = () => selectProductTab('');
            tabsContainer.appendChild(allTab);

            // Add product tabs in reordered sequence
            reorderedProducts.forEach(product => {
                const tab = document.createElement('a');
                tab.className = 'tab';
                tab.textContent = product;
                tab.onclick = () => selectProductTab(product);
                tabsContainer.appendChild(tab);
            });
            
            // Set ê°œì¸í˜• IRP as default selection
            currentProductFilter = irpProduct;
        }

        function selectProductTab(product) {
            currentProductFilter = product;
            
            // Update tab styles
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                if ((product === '' && tab.textContent === 'ì „ì²´') || tab.textContent === product) {
                    tab.classList.add('active');
                }
            });

            applyFilters();
        }

        // Initialize
        function init() {
            initializeProductTabs();
            // Select ê°œì¸í˜• IRP tab after tabs are created
            selectProductTab('ê°œì¸í˜• IRP');
        }

        function applyFilters() {
            selectedWeek = document.getElementById('weekSelector').value;
            const myBranchOnly = document.getElementById('myBranchOnly') ? document.getElementById('myBranchOnly').checked : false;

            console.log('Current product filter:', currentProductFilter);

            // Filter data
            filteredData = allData.filter(item => {
                const weekMatch = item.week === selectedWeek;
                const productMatch = currentProductFilter === '' || item.product === currentProductFilter;
                return weekMatch && productMatch;
            });

            console.log('After basic filters:', filteredData.length);

            // Apply "ë‚´ ì§€ì ë§Œ ë³´ê¸°" filter
            if (myBranchOnly) {
                // For demo purposes, let's assume user's branch is "ì„œì†Œë¬¸ì§€ì "
                const myBranch = 'ì„œì†Œë¬¸ì§€ì ';
                filteredData = filteredData.filter(item => item.branch === myBranch);
                console.log('After myBranch filter:', filteredData.length);
            }

            // Sort based on product filter
            if (currentProductFilter === '') {
                // For 'ì „ì²´', show ALL items sorted by productRank ascending, then by product name ascending
                console.log('Sorting for ì „ì²´ view');
                filteredData.sort((a, b) => {
                    if (a.productRank !== b.productRank) {
                        return a.productRank - b.productRank;
                    }
                    return a.product.localeCompare(b.product, 'ko');
                });
            } else {
                // For specific product, sort by count descending (productRank)
                console.log('Sorting for specific product view');
                filteredData.sort((a, b) => {
                    if (a.productRank !== b.productRank) {
                        return a.productRank - b.productRank;
                    }
                    return b.count - a.count;
                });
            }

            console.log('After sort, taking top 10 from:', filteredData.length);

            // Take top 10
            filteredData = filteredData.slice(0, 10);

            console.log('Final filtered data:', filteredData.length);

            renderTable();
        }

        function renderTable() {
            const tbody = document.getElementById('productStatsBody');
            document.getElementById('totalCount').textContent = filteredData.length;

            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem; color: var(--gray-500);">í•„í„° ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            tbody.innerHTML = filteredData.map((item, index) => `
                <tr data-product="${item.product}" data-branch="${item.branch}" data-index="${index}">
                    <td>${item.productRank === 1 ? 'ğŸ†' : item.productRank === 2 ? 'ğŸ¥ˆ' : item.productRank === 3 ? 'ğŸ¥‰' : ''} #${item.productRank}</td>
                    <td><strong>${item.product}</strong></td>
                    <td>${item.region}</td>
                    <td>${item.branch}</td>
                    <td class="number-cell">${item.count}</td>
                </tr>
            `).join('');

            // Add click handlers
            tbody.querySelectorAll('tr').forEach(row => {
                row.addEventListener('click', function() {
                    tbody.querySelectorAll('tr').forEach(r => r.classList.remove('active'));
                    this.classList.add('active');

                    const index = parseInt(this.dataset.index);
                    const item = filteredData[index];
                    
                    selectedProduct = item.product;
                    selectedBranch = item.branch;

                    updateRightPanel(item);
                });
            });

            // Auto-select first item
            if (filteredData.length > 0) {
                const firstRow = tbody.querySelector('tr');
                firstRow.classList.add('active');
                selectedProduct = filteredData[0].product;
                selectedBranch = filteredData[0].branch;
                updateRightPanel(filteredData[0]);
            }
        }

        function updateRightPanel(item) {
            // Update know-how section
            updateKnowhowSection(item);
            
            // Update stats section
            updateStatsSection(item);
            
            // Update target list section
            updateTargetListSection(item);
        }

        function updateKnowhowSection(item) {
            const meta = document.getElementById('knowhowMeta');
            const content = document.getElementById('knowhowContent');
            
            meta.textContent = `${item.product} - ${item.branch} | ì‹ ê·œê±´ìˆ˜: ${item.count}ê±´`;

            if (item.knowhow && item.knowhow.trim() !== '') {
                content.innerHTML = `
                    <div class="knowhow-content">${item.knowhow}</div>
                    <button class="btn" onclick="openEditKnowhow()">ìˆ˜ì •í•˜ê¸°</button>
                `;
            } else {
                content.innerHTML = `
                    <div class="knowhow-empty">
                        <div class="knowhow-empty-icon">ğŸ’¡</div>
                        <div class="knowhow-empty-text">ë‹¹ì‹ ì˜ ì˜ì—… ë…¸í•˜ìš°ë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”</div>
                        <button class="btn btn-primary" onclick="openEditKnowhow()">+ ë…¸í•˜ìš° ë“±ë¡í•˜ê¸°</button>
                    </div>
                `;
            }
        }

        function updateStatsSection(item) {
            const meta = document.getElementById('statsMeta');
            meta.textContent = `${item.product}`;
            
            updateStatsView();
        }

        function updateStatsView() {
            const statsGrid = document.getElementById('statsGrid');
            const statsType = document.getElementById('statsType').value;
            
            if (!selectedProduct || !customerStats[selectedProduct]) {
                statsGrid.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--gray-500);">ìƒí’ˆì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>';
                return;
            }

            const stats = customerStats[selectedProduct][statsType];
            
            statsGrid.innerHTML = stats.map(stat => `
                <div class="stat-item">
                    <div class="stat-label">${stat.label}</div>
                    <div class="stat-value">${stat.value}</div>
                    <div class="stat-sublabel">${stat.percent}%</div>
                </div>
            `).join('');
        }

        function updateTargetListSection(item) {
            const meta = document.getElementById('targetMeta');
            const container = document.getElementById('targetListContainer');
            
            meta.textContent = `${item.product}`;

            if (!targetLists[item.product]) {
                container.innerHTML = '<div style="padding: 2rem; text-align: center; color: var(--gray-500);">íƒ€ê²Ÿ ë¦¬ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }

            const lists = targetLists[item.product];
            
            container.innerHTML = lists.map(list => `
                <div class="target-card">
                    <div class="target-info">
                        <div class="target-title">${list.title}</div>
                        <div class="target-meta">
                            ${list.desc}
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="extractTargets(${list.id}, '${list.title}', ${list.count})">ì¶”ì¶œí•˜ê¸°</button>
                </div>
            `).join('');
        }

        function openEditKnowhow() {
            const item = filteredData.find(i => i.product === selectedProduct && i.branch === selectedBranch);
            if (!item) return;

            // Set modal subtitle
            document.getElementById('modalBranchInfo').textContent = `${item.branch} | ${item.region}`;

            // Set default template if empty, otherwise use existing knowhow
            const defaultTemplate = `ğŸ¯ ì£¼ìš” íƒ€ê²Ÿ ê³ ê°

ì´ ë©˜íŠ¸ê°€ ì‹¤ì œë¡œ ë¨¹í˜”ë˜ ê³ ê° ìœ í˜•
ì˜ˆ) ê°œì¸ì‚¬ì—…ì / ì†Œìƒê³µì¸ / 40~50ëŒ€ ì§ì¥ì¸

ğŸ”„ ì „í™˜ í¬ì¸íŠ¸ / ì„¤ë“ ë…¼ë¦¬

ê³ ê° íƒœë„ê°€ ë°”ë€ ê²°ì •ì  ì´ìœ  í•œ ê°€ì§€
ì˜ˆ)
â€¢ "ì•ˆ í•˜ë©´ ì†í•´"ë¼ëŠ” ì¸ì‹ ì „í™˜
â€¢ ì •ì±…ì„±Â·ì••ë¥˜ë°©ì§€ êµ¬ì¡° ì´í•´
â€¢ ë‹¤ë¥¸ ê¸ˆìœµìƒí’ˆê³¼ì˜ ì°¨ì´ ì¸ì§€

ğŸ—£ï¸ ì‹¤ì œ ì‚¬ìš© ì˜ì—… ë©˜íŠ¸

ì„¤ëª… ì—†ì´, ì‹¤ì œ ë§í•œ ê·¸ëŒ€ë¡œ
ì˜ˆ)
"ëŒ€í‘œë‹˜, ì´ê±´ ìˆ˜ìµ ë‚´ëŠ” ìƒí’ˆì´ ì•„ë‹ˆë¼
ì ‘ì„ ë•Œ ëŒ€í‘œë‹˜ ëª« ì§€ì¼œì£¼ëŠ” í‡´ì§ê¸ˆ í†µì¥ì…ë‹ˆë‹¤."`;

            const textArea = document.getElementById('knowhowText');
            if (item.knowhow && item.knowhow.trim() !== '') {
                textArea.value = item.knowhow;
            } else {
                textArea.value = defaultTemplate;
            }
            
            updateCharCount();
            
            document.getElementById('writeModal').classList.add('show');
        }

        function updateCharCount() {
            const textArea = document.getElementById('knowhowText');
            const charCount = document.getElementById('charCount');
            const count = textArea.value.length;
            charCount.textContent = count;
            
            if (count > 1000) {
                charCount.style.color = '#d32f2f';
            } else {
                charCount.style.color = '#999';
            }
        }

        // Add event listener for character count
        document.addEventListener('DOMContentLoaded', function() {
            const textArea = document.getElementById('knowhowText');
            if (textArea) {
                textArea.addEventListener('input', updateCharCount);
            }
        });

        function saveKnowHow() {
            const knowhowText = document.getElementById('knowhowText').value.trim();

            if (!knowhowText) {
                alert('ì˜ì—… ë…¸í•˜ìš°ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (knowhowText.length > 1000) {
                alert('ì˜ì—… ë…¸í•˜ìš°ëŠ” 1,000ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // Update data
            const item = allData.find(i => i.product === selectedProduct && i.branch === selectedBranch && i.week === selectedWeek);
            if (item) {
                item.knowhow = knowhowText;
            }

            alert('ì˜ì—… ë…¸í•˜ìš°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            closeModal('writeModal');
            
            // Refresh display
            const currentItem = filteredData.find(i => i.product === selectedProduct && i.branch === selectedBranch);
            if (currentItem) {
                updateKnowhowSection(currentItem);
            }
        }

        function extractTargets(listId, title, count) {
            document.getElementById('extractListTitle').textContent = title;
            document.getElementById('extractListCount').textContent = `${count.toLocaleString()}ëª…`;
            document.getElementById('extractModal').classList.add('show');
        }

        function confirmExtract() {
            const format = document.getElementById('extractFormat').value;
            alert(`íƒ€ê²Ÿ ë¦¬ìŠ¤íŠ¸ë¥¼ ${format.toUpperCase()} í˜•ì‹ìœ¼ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤.`);
            closeModal('extractModal');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Close modal on outside click
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        }

        // Initialize on load
        window.onload = init;
    </script>
</body>
</html>
